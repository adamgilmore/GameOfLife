<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Scripts/jquery-1.9.1.js"></script>
    <script src="Scripts/GameOfLife.js"></script>
    <link href="Default.css" rel="stylesheet" />
</head>
<body>
    <script>
        var game = null;
        var timerId;

        $(window).load(function () {

            // wire up events
            $("#startStop").on("click", function (e) {
                startStopGame();
                e.preventDefault();
            });

            $("#reset").on("click", function (e) {
                resetGame();
                e.preventDefault();
            });

            createGame();

            createGridTable();
            
            processGame();
        });

        function startStopGame() {
            if ($("#startStop").val() == "Start") {
                $("#startStop").val("Stop");
                timerId = window.setInterval(processGame, 100);
            } 
            else {
                $("#startStop").val("Start");
                window.clearInterval(timerId);
            }
        }

        function createGame() {
            game = new Game(64);
            game.randomise();
        }

        function resetGame() {
            createGame();
            processGame();
        }

        function processGame() {
            var grid = game.calculateGeneration();

            drawGridTable(grid);

            $("#generation").text(game.generation.toString());

        }

        function createGridTable() {
            for (var x = 0; x < game.size; ++x) {
                var row = document.createElement("tr");
                row.className = "row";
                
                for (var y = 0; y < game.size; ++y) {
                    var cell = document.createElement("td")
                    row.appendChild(cell);
                }

                $("#gridTable").append(row);
            }
        }

        function drawGridTable(grid) {
            var rows = $("#gridTable").find("tr.row");

            for (var x = 0; x < game.size; ++x) {
                for (var y = 0; y < game.size; ++y) {
                    if (grid.buffer[x][y] == 0)
                        rows[x].cells[y].className = "cell-dead";
                    else if (grid.buffer[x][y] == 1)
                        rows[x].cells[y].className = "cell-born";
                    else 
                        rows[x].cells[y].className = "cell-alive";
                }
            }
        }

    </script>

    <div>
        <div>
            <input id="startStop" type="button" value="Start" />
            <input id="reset" type="button" value="Reset" />
            <span id="generation"></span>
        </div>
        <div>
            <table id="gridTable">
            </table>
        </div>
    </div>
    
</body>
</html>
